## 🌟 Fitness Score Calculation Service (체력 점수 계산 서비스)

이 서비스는 사용자의 성별 및 연령대에 따른 **체력 기준표**를 바탕으로 측정값을 점수(0~100점)로 변환하는 기능을 제공합니다.

---

### 📝 프로젝트 개요 (Overview)

이 패키지는 **국민체력100** 및 **일반 체력 측정값**을 입력받아 사용자 정보(성별, 나이)에 맞는 기준표를 적용하여 항목별 체력 점수(0~100)를 계산하는 백엔드 서비스 로직을 포함합니다.

주요 목표는 체력 측정값을 표준화된 점수로 변환하여 사용자에게 피드백을 제공하는 것입니다.

### 🏛️ 주요 구성 요소 (Core Components)

| 파일 이름 | 역할 및 설명                                                                                                                                                                                  |
| :--- |:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `FitnessScoreService.java` | **메인 서비스.** DTO를 받아 사용자 나이를 계산하고, 해당 기준표를 조회한 후, `FitnessCalculator`를 사용하여 종목별 점수를 계산하고 반환합니다. **(핵심 로직)**                                                                               |
| `FitnessCalculator.java` | **점수 계산기.** 측정값과 기준 등급(1, 2등급 값)을 바탕으로 0점에서 100점 사이의 점수를 계산합니다. 선형 보간(`linear` 함수)을 사용하여 값을 변환하며, `scoreHigherIsBetter` (높을수록 좋은 종목)와 `scoreLowerIsBetter` (낮을수록 좋은 종목) 두 가지 메서드를 제공합니다. |
| `FitnessStandards.java` | **기준표 저장소.** 성별과 연령대별 체력 종목의 1, 2등급 기준값을 `Map` 형태로 저장하고 관리하는 컴포넌트입니다. 프로그램 시작 시 기준값을 메모리에 로드합니다.                                                                                         |
| `FitnessStandardSet.java` | **단일 기준표.** 특정 성별/연령대의 악력, 윗몸일으키기 등 **모든 체력 종목의 1, 2등급 기준값**을 묶어 저장하는 클래스입니다.                                                                                                            |
| `FitnessGrade.java` | **등급 기준값.** 각 체력 종목의 **1등급 값**과 **2등급 값**을 저장하는 클래스입니다.                                                                                                                                  |
| `AgeGroup.java` | 연령대의 **최소 나이**와 **최대 나이**를 저장하는 Record입니다.                                                                                                                                               |
| `Sex.java` | 성별(M/F)을 정의하는 Enum입니다.                                                                                                                                                                   |

---

### 🛠️ 주요 기능 상세 (Feature Details)

#### 1. 나이 계산 (`FitnessScoreService.calculateAge`)

* 입력된 생년월일(YYYYMMDD 형식)을 기반으로 현재 날짜를 기준으로 **만 나이**를 정확하게 계산합니다.

#### 2. 기준표 조회 (`FitnessStandards.getStandard`)

* 사용자의 **성별**과 **만 나이**를 입력받아 `FitnessStandards`에 로드된 데이터에서 해당 연령대에 해당하는 `FitnessStandardSet` (종목별 1, 2등급 기준값 세트)을 찾아 반환합니다.

#### 3. 점수 계산 로직 (`FitnessCalculator`)

* **점수 범위 가정:** 이 시스템은 체력 측정값을 **1등급**부터 **6등급**까지의 범위로 가정하고 점수를 계산합니다.
* **선형 보간 (`linear`):** 두 기준점 사이의 값을 선형적으로 변환하여 점수를 매깁니다.

    * **높을수록 좋은 종목 (`scoreHigherIsBetter`):**
        * 최대값 (`grade.getGrade1`, 1등급 기준)과 최소값 (가정된 6등급 범위) 사이에서 점수를 계산합니다.
        * **중간값**을 기준으로 0~60점 구간과 60~100점 구간으로 나누어 선형 보간을 적용합니다.
    * **낮을수록 좋은 종목 (`scoreLowerIsBetter`):**
        * 최소값 (`grade.getGrade1`, 1등급 기준)과 최대값 (가정된 6등급 범위) 사이에서 점수를 계산합니다.
        * 마찬가지로 **중간값**을 기준으로 0~60점 구간과 60~100점 구간으로 나누어 선형 보간을 적용하며, 값이 작을수록 높은 점수를 받도록 설계되었습니다.
        * 점수는 항상 $\text{0}$ 이상으로 보장됩니다 ($\text{Math.max}(\text{0}, \text{score})$).

#### 4. 서비스 분리 (`FitnessScoreService`)

* `calculateKookmin`: **국민체력100** 측정값 DTO를 처리합니다. 악력, 윗몸일으키기 등 6개 종목 모두 `FitnessCalculator`를 통해 점수를 변환합니다.
* `calculateGeneral`: **일반 체력 측정값** DTO를 처리합니다. 일부 종목(악력, 민첩성, 순발력)은 슬라이더 값(이미 점수화된 것으로 추정)을 그대로 사용하고, 나머지 종목(윗몸일으키기, 유연성, 심폐지구력)만 기준표에 따라 점수를 계산합니다.

---

### 🤝 통합 및 확장 (Integration and Extension)

이 서비스는 Spring Framework의 `@Component`와 `@Service` 어노테이션을 사용하여 다른 서비스 계층에서 쉽게 주입받아 사용할 수 있습니다.

* **새로운 기준표 추가:** `FitnessStandards.java` 파일의 `loadMaleStandards()` 또는 `loadFemaleStandards()` 메서드에 새로운 `AgeGroup`과 `FitnessStandardSet` 데이터를 추가하여 새로운 연령대 또는 기준을 쉽게 반영할 수 있습니다.
* **새로운 측정 항목 추가:** `FitnessStandardSet.java`와 관련된 DTO, 그리고 `FitnessScoreService`의 계산 로직에 새로운 종목의 기준값과 계산 로직을 추가하여 기능을 확장할 수 있습니다.